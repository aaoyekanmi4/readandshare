(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{34:function(e,t,a){e.exports=a(65)},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(15),o=a.n(r),c=a(9),s=a(12),i=a(1),u=function(e){return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:e.onSubmit,className:"ui large form"},l.a.createElement("h2",{className:"ui dividing header"},e.formTitle),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Title"),l.a.createElement("input",{name:"title",value:e.watchInput.title,onChange:e.addInput,autoComplete:"off",type:"text",placeholder:"Title of Book"})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Author"),l.a.createElement("input",{value:e.watchInput.author,name:"author",onChange:e.addInput,autoComplete:"off",type:"text",placeholder:"Author"})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Pages"),l.a.createElement("input",{value:e.watchInput.pages,name:"pages",autoComplete:"off",type:"text",onChange:e.addInput,placeholder:"Pages"})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Status"),l.a.createElement("select",{name:"status",value:e.watchInput.status,onChange:e.addInput},l.a.createElement("option",{value:"Not Started"},"Not Started"),l.a.createElement("option",{value:"Reading"},"Reading"),l.a.createElement("option",{value:"Finished Reading"},"Finished Reading"))),l.a.createElement("div",{className:"actions"},l.a.createElement("button",{className:"ui button right floated",onClick:e.onClose},"Cancel"),l.a.createElement("button",{className:"ui button primary right floated",type:"submit"},e.actionText))))},m=function(e){return l.a.createElement("form",{className:"ui large form",onSubmit:e.onSubmit},l.a.createElement("h2",{className:"ui dividing header"},e.formTitle),l.a.createElement("h3",null,'Are you sure you want to delete "'.concat(e.bookTitle,'"?')),l.a.createElement("div",{className:"actions"},l.a.createElement("button",{className:"ui button right floated",onClick:e.onClose},"Cancel"),l.a.createElement("button",{className:"ui button primary right floated negative",type:"submit"},e.actionText)))},d=a(10),p=a(3),E=a.n(p),f=a(6),h=a.n(f),b=function(e){e?h.a.defaults.headers.common["x-auth-token"]=e:delete h.a.defaults.headers.common["x-auth-token"]},g=l.a.createContext(),v=function(){var e=Object(n.useContext)(g),t=e.isAuthenticated,a=e.logout,r=e.user,o=l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"item"},"Signed in as ",r&&r.name),l.a.createElement("span",{className:"item"},l.a.createElement("a",{onClick:function(){a()},href:"#!"},"Sign Out"))),c=l.a.createElement(l.a.Fragment,null,l.a.createElement(d.b,{to:"/register",className:"item"},"Sign Up"),l.a.createElement(d.b,{to:"/login",className:"item"},"Login"));return l.a.createElement("div",{className:"ui menu"},l.a.createElement("div",{className:"left menu"},l.a.createElement(d.b,{to:"/",style:{color:"black"}},l.a.createElement("h2",null,l.a.createElement("i",{className:"book icon"})," Book App"))),l.a.createElement("div",{className:"right menu"},t?o:c))};function k(e){return e.message?l.a.createElement("div",{style:{color:"red"},className:"error"},e.message):l.a.createElement(l.a.Fragment,null)}var j=function(e){var t=Object(n.useContext)(g),a=Object(n.useState)(null),r=Object(i.a)(a,2),o=r[0],u=r[1],m=t.register,d=t.error,p=t.clearErrors,E=t.isAuthenticated,f=Object(n.useState)({name:"",email:"",password:"",password2:""}),h=Object(i.a)(f,2),b=h[0],v=h[1];Object(n.useEffect)((function(){E&&e.history.push("/"),"User already exists"===d&&u(d),p()}),[]);var j=b.name,O=b.email,N=b.password,C=b.password2,w=function(){if(N.length<6)return"Password must be at least 6 characters"},y=function(){if(N!==C)return"Passwords do not match"},x=function(e){v(Object(s.a)({},b,Object(c.a)({},e.target.name,e.target.value))),u(null)};return l.a.createElement("div",{style:{width:420,margin:"0 auto",marginTop:"10%"}},l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),m({name:j,email:O,password:N})},className:"ui  form"},l.a.createElement(k,{message:o}),l.a.createElement("h2",{className:"ui dividing header"},"Sign Up "),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Name"),l.a.createElement("input",{name:"name",value:j,onChange:x,autoComplete:"off",type:"text",required:!0})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Email"),l.a.createElement("input",{value:O,name:"email",onChange:x,autoComplete:"off",type:"email",required:!0})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Password"),l.a.createElement("input",{value:N,name:"password",type:"password",onChange:x,required:!0}),l.a.createElement(k,{message:w()})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Confirm Password"),l.a.createElement("input",{value:C,name:"password2",type:"password",onChange:x}),l.a.createElement(k,{message:y()})),l.a.createElement("div",{className:"actions"},l.a.createElement("button",{disabled:w()||y(),className:"ui button primary right floated",type:"submit"},"Sign Up"))))},O=function(e){var t=Object(n.useContext)(g),a=t.login,r=t.error,o=t.clearErrors,u=t.isAuthenticated,m=Object(n.useState)(null),d=Object(i.a)(m,2),p=d[0],E=d[1],f=Object(n.useState)({email:"",password:""}),h=Object(i.a)(f,2),b=h[0],v=h[1],j=b.email,O=b.password;Object(n.useEffect)((function(){u&&e.history.push("/"),"Invalid Credentials"!==r&&"User not found"!==r||E(r),o()}),[]);var N=function(e){return v(Object(s.a)({},b,Object(c.a)({},e.target.name,e.target.value)))};return l.a.createElement("div",{style:{width:420,margin:"0 auto",marginTop:"10%"}},l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a({email:j,password:O})},className:"ui  form"},l.a.createElement(k,{message:p}),l.a.createElement("h2",{className:"ui dividing header"},"Login "),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Email"),l.a.createElement("input",{value:j,name:"email",onChange:N,autoComplete:"off",type:"email",required:!0})),l.a.createElement("div",{className:"field"},l.a.createElement("label",null,"Password"),l.a.createElement("input",{value:O,name:"password",type:"password",autoComplete:"off",onChange:N,required:!0})),l.a.createElement("div",{className:"actions"},l.a.createElement("button",{disabled:!O||!j,className:"ui button primary right floated",type:"submit"},"Login"))))},N=a(11),C=function(e){var t=Object(n.useContext)(g),a=t.isAuthenticated,r=t.loading;return l.a.createElement(N.b,null,a||r?e.children:l.a.createElement(N.a,{to:"/login"}))},w=(a(63),function(e){return l.a.createElement("tr",{className:(t=e.status,"Finished Reading"===t?"read":"Reading"===t?"current":"not-started")},l.a.createElement("td",{className:"title"},function(e){return"Finished Reading"===e?l.a.createElement("i",{className:"icon checkmark"}):"Reading"===e?l.a.createElement("i",{className:"bookmark icon"}):l.a.createElement("i",{className:"book icon"})}(e.status)," ",e.title),l.a.createElement("td",{className:"author"},e.author),l.a.createElement("td",{className:"pages"},e.pages),l.a.createElement("td",{className:"status"},e.status),l.a.createElement("td",{style:{textAlign:"center"},className:"edit"},l.a.createElement("button",{style:{backgroundColor:"transparent",border:"none",color:"gray",cursor:"pointer"},onClick:function(){return e.edit(e.book)}},l.a.createElement("i",{className:"edit icon"}))),l.a.createElement("td",{style:{textAlign:"center"},className:"delete"},l.a.createElement("button",{style:{backgroundColor:"transparent",border:"none",color:"red",cursor:"pointer"},onClick:function(){return e.delete(e.id,e.title)}},l.a.createElement("i",{className:"trash alternate outline icon"}))));var t}),y=l.a.createContext(),x=(a(64),function(e){var t=Object(n.useContext)(y),a=t.books,r=t.getBooksByUser;Object(n.useEffect)((function(){r()}),[]);var o=a.map((function(t,a){return l.a.createElement(w,{key:a,id:t._id,title:t.title,author:t.author,pages:t.pages,status:t.status,edit:e.clickEdit,delete:e.clickDelete,book:t})}));return l.a.createElement("div",null,l.a.createElement("table",{className:"ui table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Title"),l.a.createElement("th",null,"Author"),l.a.createElement("th",null,"Pages"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Edit"),l.a.createElement("th",null,"Delete"))),l.a.createElement("tbody",null,a?o:"Loading...")))}),S=a(29),T=a(30),B=a(32),A=a(31),I=a(33),D=function(e){function t(){return Object(S.a)(this,t),Object(B.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return this.props.show?o.a.createPortal(l.a.createElement("div",{onClick:this.props.onClose,className:"ui dimmer modals visible active"},l.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"ui standard modal visible active",style:{width:"30%",padding:50}},this.props.children)),document.getElementById("modal")):null}}]),t}(l.a.Component),F=function(e){return l.a.createElement("div",{style:e.color,class:"ui message"},l.a.createElement("p",null,e.message))},P=function(e){var t=Object(n.useContext)(g).loadUser;return Object(n.useEffect)((function(){t()}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"ui container"},l.a.createElement("h1",{className:"ui header",style:{textAlign:"center",marginBottom:"140px",marginTop:"60px"}},"Book App"),e.showFlash?l.a.createElement(F,{color:e.flashColor,message:e.message}):null,l.a.createElement(x,{clickEdit:e.showEditBook,clickDelete:e.showDeleteBook}),l.a.createElement("button",{style:{marginTop:10},onClick:e.showAddBook,className:"ui primary button right floated"},"Add Book"),l.a.createElement(D,{show:e.isModalOpen,onClose:e.toggleModal,actionText:e.crudAction},e.pickModalChild())))},R=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],r=a[1],o=Object(n.useRef)(!0);return Object(n.useEffect)((function(){o.current?o.current=!1:(r(!0),setTimeout((function(){r(!1)}),3e3),console.log("useEffect ran"))}),[e]),{showFlash:l}},U=function(){localStorage.token&&b(localStorage.token);var e=Object(n.useContext)(y),t=e.addBook,a=e.deleteBook,r=e.editBook,o=Object(n.useState)(!1),d=Object(i.a)(o,2),p=d[0],E=d[1],f=Object(n.useState)(null),h=Object(i.a)(f,2),g=h[0],k=h[1],w=Object(n.useState)({id:"",title:"",author:"",pages:"",status:"Not Started"}),x=Object(i.a)(w,2),S=x[0],T=x[1],B=Object(n.useState)(""),A=Object(i.a)(B,2),I=A[0],D=A[1],F=R(I).showFlash,U=Object(n.useState)(null),M=Object(i.a)(U,2),q=M[0],L=M[1],J=function(e){e.preventDefault(),t(S),H(),D('Succesfully added "'.concat(S.title,'"')),L({border:"1px solid green"})},_=function(e){e.preventDefault(),a(S.id),H(),D('Deleted "'.concat(S.title,'"')),L({border:"1px solid red"})},z=function(e){e.preventDefault(),console.log(S),r(S),H(),D('Edited "'.concat(S.title,'"')),L({border:"1px solid orange"})},G=function(e){var t=e.target.name,a=e.target.value;T((function(e){return Object(s.a)({},e,Object(c.a)({},t,a))}))},H=function(){E(!p),k(null)};return l.a.createElement(l.a.Fragment,null,l.a.createElement(v,null),l.a.createElement(N.d,null,l.a.createElement(C,{exact:!0,path:"/"},l.a.createElement(P,{flashColor:q,message:I,showEditBook:function(e){T({id:e._id,title:e.title,author:e.author,status:e.status,pages:e.pages}),H(),k("Edit")},showDeleteBook:function(e,t){H();var a={id:e,title:t};k("Delete"),T(Object(s.a)({},S,{},a))},showAddBook:function(){T({id:"",title:"",author:"",pages:"",status:"Not Started"}),H(),k("Add")},isModalOpen:p,pickModalChild:function(){return"Add"===g?l.a.createElement(u,{formTitle:"Add New Book",actionText:g,onClick:J,addInput:G,onSubmit:J,watchInput:S,onClose:H}):"Edit"===g?l.a.createElement(u,{formTitle:"Edit Book",actionText:g,addInput:G,watchInput:S,onClose:H,onSubmit:z}):"Delete"===g?l.a.createElement(m,{formTitle:"Delete Book",actionText:g,onSubmit:_,onClose:H,bookTitle:S.title}):void 0},toggleModal:H,crudAction:g,showFlash:F})),"/>",l.a.createElement(N.b,{path:"/register",component:j}),l.a.createElement(N.b,{path:"/login",component:O})))};o.a.render(l.a.createElement(d.a,null,l.a.createElement((function(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),u=s[0],m=s[1],d=function(){var e,t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e={header:{"Content-Type":"application/json"}},n.prev=1,n.next=4,E.a.awrap(h.a.get("/api/books",e));case 4:t=n.sent,o(t.data),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),a=n.t0.response.data.msg,m(a);case 12:case"end":return n.stop()}}),null,null,[[1,8]])};return l.a.createElement(y.Provider,{value:{books:r,addBook:function(e){var t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={header:{"Content-Type":"application/json"}},n.prev=1,n.next=4,E.a.awrap(h.a.post("/api/books",e,t));case 4:d(),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(1),a=n.t0.response.data.msg,m(a);case 11:case"end":return n.stop()}}),null,null,[[1,7]])},getBooksByUser:d,deleteBook:function(e){var t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={header:{"Content-Type":"application/json"}},n.prev=1,n.next=4,E.a.awrap(h.a.delete("/api/books/".concat(e),t));case 4:d(),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(1),a=n.t0.response.data.msg,m(a);case 11:case"end":return n.stop()}}),null,null,[[1,7]])},editBook:function(e){var t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={header:{"Content-Type":"application/json"}},n.prev=1,n.next=4,E.a.awrap(h.a.put("/api/books/".concat(e.id),e,t));case 4:d(),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(1),a=n.t0.response.data.msg,m(a);case 11:case"end":return n.stop()}}),null,null,[[1,7]])},error:u}},e.children)}),null,l.a.createElement((function(e){var t=Object(n.useState)(localStorage.getItem("token")),a=Object(i.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),u=s[0],m=s[1],d=Object(n.useState)(!0),p=Object(i.a)(d,2),f=p[0],v=p[1],k=Object(n.useState)(null),j=Object(i.a)(k,2),O=j[0],N=j[1],C=Object(n.useState)(null),w=Object(i.a)(C,2),y=w[0],x=w[1],S=function(){var e,t;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return localStorage.token&&b(localStorage.token),a.prev=1,a.next=4,E.a.awrap(h.a.get("/api/auth"));case 4:e=a.sent,m(!0),v(!1),x(e.data),a.next=18;break;case 10:a.prev=10,a.t0=a.catch(1),t=a.t0.response.data.msg,localStorage.removeItem("token"),N(t),o(null),v(!1),x(null);case 18:case"end":return a.stop()}}),null,null,[[1,10]])};return l.a.createElement(g.Provider,{value:{logout:function(){localStorage.removeItem("token"),m(!1),o(null),v(!1),x(null)},register:function(e){var t,a,n,l;return E.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t={headers:{"Content-Type":"application/json"}},r.prev=1,r.next=4,E.a.awrap(h.a.post("/api/users",e,t));case 4:a=r.sent,n=a.data.token,localStorage.setItem("token",n),o(n),m(!0),v(!1),S(),r.next=21;break;case 13:r.prev=13,r.t0=r.catch(1),l=r.t0.response.data.msg,localStorage.removeItem("token"),N(l),o(null),v(!1),x(null);case 21:case"end":return r.stop()}}),null,null,[[1,13]])},login:function(e){var t,a,n,l;return E.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t={headers:{"Content-Type":"application/json"}},r.prev=1,r.next=4,E.a.awrap(h.a.post("/api/auth",e,t));case 4:a=r.sent,n=a.data.token,localStorage.setItem("token",n),o(n),m(!0),v(!1),S(),r.next=17;break;case 13:r.prev=13,r.t0=r.catch(1),l=r.t0.response.data.msg,N(l);case 17:case"end":return r.stop()}}),null,null,[[1,13]])},token:r,isAuthenticated:u,loading:f,error:O,user:y,clearErrors:function(){return N(null)},loadUser:S}},e.children)}),null,l.a.createElement(U,null)))),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.2e25b144.chunk.js.map